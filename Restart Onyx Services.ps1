$onyxStart = Get-Service -Name Onyx* | ForEach-Object {@{$_.Name = $_.StartType}}; Write-Host "Disabling Onyx Services"; Get-Service -Name Onyx* | Set-Service -StartupType Disabled; Sleep 1; Write-Host "Stopping Onyx Processes"; Get-Process -Name ExecutionService -ea SilentlyContinue| Stop-Process -Force -ea SilentlyContinue; Get-Process -Name TimecodeService -ea SilentlyContinue | Stop-Process -Force -ea SilentlyContinue; Sleep 1; Write-Host "Enabling Onyx Services"; $onyxStart | ForEach-Object {Set-Service $_.Keys -StartupType $_.Values}; Write-Host "Starting Onyx Services"; $onyxStart | ForEach-Object {Start-Service $_.Keys}